#ifndef ABRTOS_KERNEL_LOADED
#define ABRTOS_KERNEL_LOADED

' ARMbasic[7.43a] on the 2138  Copyright 2008, Coridium Corp.
' blk=1000 var=7424 DATAstart=7c000 end=7d000
' code=4000 var=7424 DATAstart=7c000 end=7d000

#if 1	' LIBRARY INCLUDES

	#include "ABRTOS_INC\ABRTOS_DEFS.BAS"
	
	#if ABRTOS_OPTION_USE_LOGGING == 1
		#include "ABRTOS_INC\ABRTOS_LOG.BAS"
	#endif
	
	#include "ABRTOS_INC\ABRTOS_INT.BAS"
	' #include "ABRTOS_INC\ABRTOS_DEBUG.BAS"

	#if ABRTOS_OPTION_USE_WDT == 1
		#include "ABRTOS_INC\ABRTOS_WDT.BAS"
	#endif

	' #include "ABRTOS_INC\ABRTOS_MEM.BAS"
	' #include "ABRTOS_INC\ABRTOS_EVENT.BAS"
	' #include "ABRTOS_INC\ABRTOS_STACK.BAS"

	#include "ABRTOS_INC\ABRTOS_TASKS.BAS"

	#if ABRTOS_OPTION_USE_MSGS == 1
		' #include "ABRTOS_INC\ABRTOS_MSGS.BAS"
	#endif

	#if ABRTOS_OPTION_USE_SEMAPHORES == 1
		#include "ABRTOS_INC\ABRTOS_SEMA.BAS"
	#endif

	#if ABRTOS_OPTION_USE_MUTEX == 1
		' #include "ABRTOS_INC\ABRTOS_MUTEX.BAS"
	#endif

	#include "ABRTOS_INC\ABRTOS_SCHED.BAS"
	#include "ABRTOS_INC\ABRTOS_INIT.BAS"
	
#endif

#if 1	' MODULE DEFINITIONS
#define ABRTOS_MOD		ABRTOS_LOG_MOD_CORE

#endif

MAIN:
	TIMER = 0
	ABRTOS_INIT_STARTUP
	ABRTOS_TASK_INITTASKMGMT
	ABRTOS_SCHED_START
	ABRTOS_TASK_ACTIVEID = 0
	ABRTOS_SEMA_INIT_SEMAPHORE(0, 2, 2)
	ABRTOS_SEMA_INIT_SEMAPHORE(1, 2, 2)
	ABRTOS_SEMA_INIT_SEMAPHORE(2, 2, 2)
	ABRTOS_SEMA_INIT_SEMAPHORE(3, 2, 2)
	ABRTOS_SEMA_INIT_SEMAPHORE(4, 2, 2)
	ABRTOS_TASK_ACTIVEID = 1
	ABRTOS_SEMA_INIT_SEMAPHORE(0, 2, 2)
	ABRTOS_TASK_ACTIVEID = 2
	ABRTOS_SEMA_GET_SEMAPHORE(0)
	ABRTOS_TASK_ACTIVEID = 3
	ABRTOS_SEMA_GET_SEMAPHORE(1)
	ABRTOS_TASK_ACTIVEID = 4
	ABRTOS_SEMA_GET_SEMAPHORE(2)
	ABRTOS_TASK_ACTIVEID = 5
	ABRTOS_SEMA_GET_SEMAPHORE(3)
	ABRTOS_TASK_ACTIVEID = 6
	ABRTOS_SEMA_GET_SEMAPHORE(4)
	ABRTOS_TASK_ACTIVEID = 32
	ABRTOS_SEMA_GET_SEMAPHORE(0)
	ABRTOS_TASK_ACTIVEID = 11
	ABRTOS_SEMA_GET_SEMAPHORE(0)
	ABRTOS_TASK_ACTIVEID = 7
	ABRTOS_SEMA_GET_SEMAPHORE(0)
	' ABRTOS_TASK_ACTIVEID = 64
	' ABRTOS_SEMA_GET_SEMAPHORE(1)
	' ABRTOS_TASK_ACTIVEID = 96
	' ABRTOS_SEMA_GET_SEMAPHORE(2)
	' ABRTOS_TASK_ACTIVEID = 128
	' ABRTOS_SEMA_GET_SEMAPHORE(3)
	' ABRTOS_TASK_ACTIVEID = 160
	' ABRTOS_SEMA_GET_SEMAPHORE(4)
	' ABRTOS_TASK_ACTIVEID = 192
	' ABRTOS_SEMA_GET_SEMAPHORE(0)
	' ABRTOS_TASK_ACTIVEID = 224
	' ABRTOS_SEMA_GET_SEMAPHORE(1)
	' ABRTOS_TASK_ACTIVEID = 255
	' ABRTOS_SEMA_GET_SEMAPHORE(2)
	' ABRTOS_TASK_ACTIVEID = 254
	' ABRTOS_SEMA_GET_SEMAPHORE(2)
	DO
	LOOP
	ABRTOS_SCHED_STOP
	PRINT "ABRTOS EXITING.  GOOD BYE"
END
#endif
