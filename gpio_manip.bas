#include "__LIB\AB_Extensions.lib"

' Enable the clock to the IOCON in the SYSAHBCLKCTRL register (Table 35, bit 18).
#define LPC_SYSCTL_BASE 		$40048000   
#define LPC_SYSCON      		LPC_SYSCTL      
#define LPC_GPIO_PORT_BASE  	$A0000000

#define LPC_GPIO_PORT_B00 		*$A0000000
#define LPC_GPIO_PORT_B01 		*$A0000001
#define LPC_GPIO_PORT_B02 		*$A0000002
#define LPC_GPIO_PORT_B03 		*$A0000003
#define LPC_GPIO_PORT_B04 		*$A0000004
#define LPC_GPIO_PORT_B05 		*$A0000005
#define LPC_GPIO_PORT_B06 		*$A0000006
#define LPC_GPIO_PORT_B07 		*$A0000007
#define LPC_GPIO_PORT_B08 		*$A0000008
#define LPC_GPIO_PORT_B09 		*$A0000009
#define LPC_GPIO_PORT_B10 		*$A000000A
#define LPC_GPIO_PORT_B11 		*$A000000B
#define LPC_GPIO_PORT_B12 		*$A000000C
#define LPC_GPIO_PORT_B13 		*$A000000D
#define LPC_GPIO_PORT_B14 		*$A000000E
#define LPC_GPIO_PORT_B15 		*$A000000F
#define LPC_GPIO_PORT_B16 		*$A0000010
#define LPC_GPIO_PORT_B17 		*$A0000011
#define LPC_GPIO_PORT_B18 		*$A0000012
#define LPC_GPIO_PORT_B19 		*$A0000013
#define LPC_GPIO_PORT_B20 		*$A0000014
#define LPC_GPIO_PORT_B21 		*$A0000015
#define LPC_GPIO_PORT_B22 		*$A0000016
#define LPC_GPIO_PORT_B23 		*$A0000017
#define LPC_GPIO_PORT_B24 		*$A0000018
#define LPC_GPIO_PORT_B25 		*$A0000019
#define LPC_GPIO_PORT_B26 		*$A000001A
#define LPC_GPIO_PORT_B27 		*$A000001B
#define LPC_GPIO_PORT_B28 		*$A000001C

#define LPC_GPIO_PORT_W00 		*$A0001000
#define LPC_GPIO_PORT_W01 		*$A0001004
#define LPC_GPIO_PORT_W02 		*$A0001008
#define LPC_GPIO_PORT_W03 		*$A000100C
#define LPC_GPIO_PORT_W04 		*$A0001010
#define LPC_GPIO_PORT_W05 		*$A0001014
#define LPC_GPIO_PORT_W06 		*$A0001018
#define LPC_GPIO_PORT_W07 		*$A000101C
#define LPC_GPIO_PORT_W08 		*$A0001020
#define LPC_GPIO_PORT_W09 		*$A0001024
#define LPC_GPIO_PORT_W10 		*$A0001028
#define LPC_GPIO_PORT_W11 		*$A000102C
#define LPC_GPIO_PORT_W12 		*$A0001030
#define LPC_GPIO_PORT_W13 		*$A0001034
#define LPC_GPIO_PORT_W14 		*$A0001038
#define LPC_GPIO_PORT_W15 		*$A000103C
#define LPC_GPIO_PORT_W16 		*$A0001040
#define LPC_GPIO_PORT_W17 		*$A0001044
#define LPC_GPIO_PORT_W18 		*$A0001048
#define LPC_GPIO_PORT_W19 		*$A000104C
#define LPC_GPIO_PORT_W20 		*$A0001050
#define LPC_GPIO_PORT_W21 		*$A0001054
#define LPC_GPIO_PORT_W22 		*$A0001058
#define LPC_GPIO_PORT_W23 		*$A000105C
#define LPC_GPIO_PORT_W24 		*$A0001060
#define LPC_GPIO_PORT_W25 		*$A0001064
#define LPC_GPIO_PORT_W26 		*$A0001068
#define LPC_GPIO_PORT_W27 		*$A000106C
#define LPC_GPIO_PORT_W28 		*$A0001070

#define LPC_GPIO_PORT_DIR0		*$A0002000
#define LPC_GPIO_PORT_MASK0		*$A0002080
#define LPC_GPIO_PORT_PIN0		*$A0002100
#define LPC_GPIO_PORT_MPIN0		*$A0002180
#define LPC_GPIO_PORT_SET0		*$A0002200
#define LPC_GPIO_PORT_CLR0		*$A0002280
#define LPC_GPIO_PORT_NOT0		*$A0002300
#define LPC_GPIO_PORT_DIRSET0	*$A0002380
#define LPC_GPIO_PORT_DIRCLR0	*$A0002400
#define LPC_GPIO_PORT_DIRNOT0	*$A0002480

#define SYSAHBCLKCTRL *$40048080
#define SYSAHBCLK_IOCONCLK 18
#define SYSAHBCLK_GPIOCLK 6

main:
	dim i as integer

	Print "Running..."
	
	if BITTEST(SYSAHBCLKCTRL,SYSAHBCLK_IOCONCLK)=disabled then SETBIT(SYSAHBCLKCTRL,SYSAHBCLK_IOCONCLK)
	if BITTEST(SYSAHBCLKCTRL,SYSAHBCLK_GPIOCLK)=disabled then SETBIT(SYSAHBCLKCTRL,SYSAHBCLK_GPIOCLK)

	LPC_GPIO_PORT_DIR0 = ($F << 24) ' GPIO 27-24 are outputs
	LPC_GPIO_PORT_MASK0 = not ($F << 24) ' GPIO 27-24 are the ones we are working with here - 0 enable, 1 masked
	i=0

	DO
	LPC_GPIO_PORT_MPIN0 = (i << 24)
	waitmicro(1000)
	i+=1
	loop									

end
